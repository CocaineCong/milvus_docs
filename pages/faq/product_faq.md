---
id: product_faq.md
summary: 寻找关于世界上最先进的向量数据库的常见问题答案。
title: 产品常见问题解答
---

# 产品常见问题解答

<!-- 目录 -->



<!-- 目录结束 -->

#### Milvus的费用是多少？

Milvus是一个100%免费的开源项目。

在生产或分发用途中使用Milvus时，请遵守[Apache License 2.0](http://www.apache.org/licenses/LICENSE-2.0)。

Milvus背后的公司Zilliz还提供了一个完全托管的云版本平台，供那些不想构建和维护自己的分布式实例的人使用。[Zilliz Cloud](https://zilliz.com/cloud)自动维护数据可靠性，并允许用户只为他们使用的付费。

#### Milvus是否支持非x86架构？

Milvus无法在非x86平台上安装或运行。

您的CPU必须支持以下指令集之一才能运行Milvus：SSE4.2、AVX、AVX2、AVX512。这些都是专用于x86的SIMD指令集。

#### Milvus能处理的最大数据集大小是多少？

理论上，Milvus能处理的最大数据集大小由运行它的硬件决定，具体是系统内存和存储：

- Milvus在运行查询之前将所有指定的集合和分区加载到内存中。因此，内存大小决定了Milvus可以查询的最大数据量。
- 当向Milvus添加新的实体和与集合相关的模式（目前仅支持MinIO进行数据持久化）时，系统存储决定了插入数据的最大允许大小。

#### Milvus在哪里存储数据？

Milvus处理两种类型的数据，插入的数据和元数据。

插入的数据，包括向量数据、标量数据和特定集合的模式，都作为增量日志存储在持久存储中。Milvus支持多个对象存储后端，包括[MinIO](https://min.io/)、[AWS S3](https://aws.amazon.com/s3/?nc1=h_ls)、[Google Cloud Storage](https://cloud.google.com/storage?hl=en#object-storage-for-companies-of-all-sizes) (GCS)、[Azure Blob Storage](https://azure.microsoft.com/en-us/products/storage/blobs)、[Alibaba Cloud OSS](https://www.alibabacloud.com/product/object-storage-service)和[Tencent Cloud Object Storage](https://www.tencentcloud.com/products/cos) (COS)。

元数据是在Milvus内部生成的。每个Milvus模块都有自己的元数据，它们存储在etcd中。

#### 为什么etcd中没有向量数据？

etcd存储Milvus模块的元数据；MinIO存储实体。

#### Milvus是否支持同时插入和搜索数据？

是的。插入操作和查询操作由两个独立的模块处理，它们是相互独立的。从客户端的角度来看，当插入的数据进入消息队列时，插入操作就完成了。然而，插入的数据在加载到查询节点之前是不可搜索的。如果段的大小没有达到构建索引的阈值（默认为512 MB），Milvus会使用暴力搜索，查询性能可能会降低。

#### 可以将具有重复主键的向量插入到Milvus中吗？

是的。Milvus不检查向量主键是否重复。

#### 当插入具有重复主键的向量时，Milvus是否将其视为更新操作？

不。Milvus目前不支持更新操作，也不检查实体主键是否重复。您需要确保实体主键是唯一的，如果它们不是，Milvus可能包含具有重复主键的多个实体。

如果发生这种情况，当查询时返回哪份数据的行为是未知的。这个限制将在未来的版本中得到修复。

#### 自定义实体主键的最大长度是多少？

实体主键必须是非负的64位整数。

#### 每次插入操作可以添加的最大数据量是多少？

插入操作的大小不得超过1,024 MB。这是由gRPC施加的限制。

#### 在特定分区中搜索时，集合大小是否会影响查询性能？

不。如果为搜索指定了分区，Milvus只搜索指定的分区。

#### 在为搜索指定分区时，Milvus是否加载整个集合？

不。Milvus有不同的行为。在搜索之前必须将数据加载到内存中。

- 如果您知道数据所在的分区，先调用`load_partition()`加载所需的分区，然后在`search()`方法调用中指定分区。
- 如果您不知道确切的分区，先调用`load_collection()`，然后再调用`search()`。
- 如果在搜索之前未能加载集合或分区，Milvus将返回错误。

#### 在插入向量后可以创建索引吗？
对如果之前通过“create_index（）”为集合建立了索引，Milvus将自动为随后插入的向量建立索引。但是，Milvus不会建立索引，直到新插入的矢量填充整个线段，并且新创建的索引文件与前一个文件分离。

#### FLAT和IVF_FLAT索引有何不同？

IVF_FLAT索引将向量空间划分为列表簇。在默认列表值16384处，Milvus比较目标向量和所有16384个簇的质心之间的距离，以返回最接近的簇。Milvus然后比较目标向量和所选聚类中的向量之间的距离，以获得最近的向量。与IVF_FLAT不同，FLAT直接比较目标矢量与其他矢量之间的距离。
当向量总数近似等于nlist时，IVF_FLAT和FLAT之间在计算要求和搜索性能方面几乎没有距离。然而，当矢量的数量超过nlist两倍或更多时，IVF_FLAT开始显示出性能优势。
有关详细信息，请参见[Vector Index]（Index.md）。

#### Milvus如何刷新数据？
当插入的数据加载到消息队列时，Milvus返回成功。但是，数据尚未刷新到磁盘。然后Milvus的数据节点将消息队列中的数据作为增量日志写入持久存储。如果调用了“flush（）”，数据节点将被迫立即将消息队列中的所有数据写入持久存储。

#### 什么是归一化？为什么需要归一化？

归一化是指将向量转换为其范数等于1的过程。如果使用内积来计算向量相似度，则必须对向量进行归一化。归一化后，内积等于余弦相似度。
参见[维基百科](https://en.wikipedia.org/wiki/Unit_vector)了解更多信息。

#### 为什么欧几里得距离（L2）和内积（IP）返回不同的结果？

对于归一化向量，欧几里得距离（L2）在数学上等价于内积（IP）。如果这些相似性度量返回不同的结果，请检查向量是否已归一化

#### Milvus中集合和分区的总数有限制吗？

对在一个Milvus实例中，最多可以创建65535个集合。在计算现有集合的数量时，Milvus会统计所有包含碎片和分区的集合。
例如，假设您已经创建了100个集合，其中60个集合中有2个碎片和4个分区，其余40个集合中则有1个碎片和12个分区。当前集合的数量可以计算为：
```
60 * 2 * 4 + 40 * 1 * 12 = 960
```
#### 为什么在搜索“topk”矢量时得到的矢量少于k个？

在Milvus支持的指标中，IVF_FLAT和IVF_SQ8实现了k均值聚类方法。数据空间被划分为“nlist”簇，并且插入的向量被分配到这些簇。Milvus然后选择“nprobe”最近的聚类，并比较目标向量与所选聚类中所有向量之间的距离，以返回最终结果。
如果“nlist”和“topk”较大，而nprobe较小，则nprobe簇中的矢量数量可能小于“k”。因此，当您搜索“topk”最近的矢量时，返回的矢量数量小于“k”。
若要避免这种情况，请尝试将“nprobe”设置为更大、“nlist”和“k”设置为更小。
有关详细信息，请参见[Vector Index]（Index.md）。

#### Milvus支持的最大矢量维数是多少？

Milvus可以管理多达32768个维度的矢量。

#### Milvus支持Apple M1 CPU吗？

当前的Milvus版本不支持Apple M1 CPU。

#### Milvus在主键字段上支持哪些数据类型？
在当前版本中，Milvus同时支持INT64和字符串。

#### Milvus可扩展吗？

对您可以通过Kubernetes上的Helm Chart部署具有多个节点的Milvus集群。有关更多说明，请参阅[Scale-Guide]（scaleout.md）。

#### 查询在内存中执行吗？什么是增量数据和历史数据？

对当查询请求到来时，Milvus通过将增量数据和历史数据加载到内存中来搜索它们。增量数据位于增长段中，在达到存储引擎中要持久化的阈值之前，这些增长段被缓冲在内存中，而历史数据则来自存储在对象存储中的密封段。增量数据和历史数据共同构成了要搜索的整个数据集。

#### Milvus可用于并发搜索吗？

对对于同一集合上的查询，Milvus同时搜索增量数据和历史数据。但是，对不同集合的查询是按顺序进行的。尽管历史数据可能是一个极其庞大的数据集，但对历史数据的搜索相对更耗时，而且基本上是串行执行的。

#### 为什么删除相应的集合后，MinIO中的数据仍保留？

MinIO中的数据被设计为保留一段时间，以方便数据回滚。

#### Milvus支持Pulsar以外的消息引擎吗？

对Milvus 2.1.0支持Kafka。

#### 搜索和查询之间有什么区别？

在Milvus中，向量相似度搜索基于相似度计算和向量索引加速来检索向量。与向量相似性搜索不同，向量查询通过基于布尔表达式的标量过滤来检索向量。布尔表达式对标量字段或主键字段进行筛选，并检索与筛选匹配的所有结果。在查询中，既不涉及相似性度量也不涉及向量索引。

#### 为什么在Milvus中浮点矢量值的精度为小数点后7位？

Milvus支持将矢量存储为Float32数组。Float32值的精度为小数点后7位。即使Float64值为1.3476964684980388，Milvus也会将其存储为1.347696。因此，当您从Milvus检索这样一个向量时，Float64值的精度会丢失。

#### Milvus如何处理矢量数据类型和精度？

Milvus支持二进制、浮点32、浮点16和BFloat16矢量类型。

- 二进制矢量：将二进制数据存储为0和1的序列，用于图像处理和信息检索。
- 浮点32矢量：默认存储，精度约为小数点后7位。即使Float64值也是以Float32精度存储的，这会导致检索时潜在的精度损失。
- Floa16和BFloat16矢量：降低精度和内存使用率。Floa16适用于带宽和存储有限的应用程序，而BFloat16平衡了范围和效率，通常用于深度学习，以减少计算需求，而不会显著影响准确性。

#### 还有问题吗？

你可以：

- 查看[Milvus](https://github.com/milvus-io/milvus/issues)在GitHub上。欢迎您提出问题、分享想法并帮助他人。
- 加入我们的[Slack社区](https://slack.milvus.io/)寻求支持并与我们的开源社区互动。